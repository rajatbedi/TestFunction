FROM node:20

# Install Java (for Firebase Emulator)
RUN apt-get update && apt-get install -y default-jre

# Set working directory
WORKDIR /app

# Copy project
COPY . .

# Go into functions directory and install dependencies
WORKDIR /app/functions
RUN npm install

# Install Firebase CLI
RUN npm install -g firebase-tools

# Expose the emulator port
EXPOSE 5001

# Start the emulator
CMD ["firebase", "emulators:start", "--only", "functions"]
